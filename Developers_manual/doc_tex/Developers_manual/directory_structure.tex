% =============================================================================
% The CGAL Developers' Manual
% Chapter: Directory Structure for Packages
% -----------------------------------------------------------------------------
% file   : directory_structure.tex
% authors: Geert-Jan Giezeman <geert@cs.uu.nl> & Susan Hert <hert@mpi-sb.mpg.de>
% -----------------------------------------------------------------------------
% $Id$
% $Date$
% =============================================================================

\chapter{Directory Structure for Packages\label{chap:directory_structure}}
\ccIndexMainItemBegin{directory structure}
\ccIndexSubitemBegin{submitting}{directory structure for}
\ccChapterRelease{Chapter Version: 1.1}
\ccChapterAuthor{Geert-Jan Giezeman ({\tt geert@cs.uu.nl})\\
                 Susan Hert ({\tt hert@mpi-sb.mpg.de})\\
                 Sylvain Pion}

In order for code, demos, documentation, {\em etc.} developed for \cgal\ to 
be included in an automated way into the internal (and public) releases of the 
library, the files must be organized in a specific directory structure, which 
we describe here.  We describe the entire directory structure for a package. 
Not every package will have all the parts described here. Only the files
{\tt maintainer} and {\tt description.txt} 
are obligatory.
\index{maintainer file@{\tt maintainer} file}
\ccIndexMainItem{\tt description.txt}
Submissions should not contain files in other places than described here.
It is possible to have some under SVN, but they need to be listed in the
\ccc{dont_submit} file to avoid being submitted.
Make sure your package does not have any file clashing with any other packages
(for example two files named {\tt simple\_example.cpp} in the example directories of 
two different packages will clash in the target names of cmake).


The directory structure of a package named Package should be as follows: 

\begin{verbatim}
      +--- dont_submit
      |
      +--- include/CGAL/
      |
      +--- src/{CGAL|CGALQt|...}/
      |
      +--- test/<testdir>/
      |
      +--- doc_tex/
      |
      +--- examples/<exampledir>/
      |
      +--- demo/<demodir>/
      |
      +--- benchmark/<benchmarkdir>/
      |
      +--- auxiliary/
      |
      +--- scripts/
      |
      +--- developer_scripts/
      |
      +--- package_info/Package/
                               |
                               +- description.txt
                               |
                               +- long_description.txt
                               |
                               +- maintainer
\end{verbatim}


\begin{description}
  \item[{\tt include/CGAL}]\index{include/CGAL directory@{\tt include/CGAL} directory}
       \index{source\ files!{\tt .h} files}
       contains the {\tt .h} files for the package.
  \item[{\tt src}]\index{src directory@{\tt src} directory}
       \index{source\ files!{\tt .cpp} files}
       contains the {\tt .cpp} files (if any) for the package.
       They are gathered in subdirectories corresponding to each
       library (be it static or shared).
  \item[{\tt test}]\index{test directory@{\tt test} directory!for
         packages} contains the test suite code for the package. See
       Section~\ref{sec:test_subdirectory} for a detailed description.
  \item[{\tt doc\_tex}]\index{doc_tex directory@{\tt doc\_tex} directory}
       \ccIndexSubitem{source files}{documentation}
       contains the documentation for the user and reference manuals.
       These are the files used to produce the manuals for public releases and
       to run the internal release reference manual test suite.
       See Section~\ref{sec:doc_tex_subdirectory} for a detailed description 
       of this subdirectory.
       See Chapter~\ref{chap:specification} for guidelines for producing
       the documentation.
  \item[{\tt examples}]\index{examples directory@{\tt examples} directory}
       contains the example programs for the package.
       See Section~\ref{sec:examples_subdirectory} for a detailed 
       description of this subdirectory.
  \item[{\tt demo}]\index{demo directory@{\tt demo} directory}
       contains the demo programs for the package.
       Contrary to example programs, demo programs are not expected to be
       usable on all platforms. Demo programs may depend on platform-specific
       software and may require user interaction.  They are compiled but not
       run in the test suite. See Section~\ref{sec:demo_subdirectory} for a
       more detailed description of this subdirectory.
  \item[{\tt benchmark}]\index{benchmark directory@{\tt benchmark} directory}
       contains the benchmark programs for the package.
       See Section~\ref{sec:benchmark_subdirectory} for a detailed 
       description of this subdirectory.
  \item[{\tt auxiliary}]\index{auxiliary directory@{\tt auxiliary}
       directory} contains auxiliary software for CGAL. For
       instance, GMP goes here when using the Windows installer.
       The average package won't have this directory.
  \item[{\tt scripts}]\index{scripts directory@{\tt scripts}
       directory} contains scripts that are of interest to \cgal\ users.
  \item[{\tt developer\_scripts}]\index{developers\_scripts
       directory@{\tt developers\_scripts} directory} contains
       scripts that are of interest to \cgal\ developers. This directory
       is included in internal releases only, not in public releases.
  \item[{\tt dont\_submit}]%
    \ccIndexMainItem{\tt dont\_submit} specifies files and directories
    that are to be excluded from the release, for example:
    \begin{verse}
      TODO\\
      include/CGAL/my\_internal\_file.h\\
      benchmark      
    \end{verse}
  \item[{\tt package\_info/Package/description.txt}]%
       \ccIndexMainItem{\tt description.txt}
       should give a very short description of the contents of the package. 
  \item[{\tt long\_description.txt}]%
       \ccIndexMainItem[c]{\tt package\_info/Package/long\_description.txt}
       may be added with more detailed information about the package. 
  \item[\ccAnchor{maintainer}{{\tt package\_info/Package/maintainer}}]%
       \index{maintainer file@{\tt maintainer} file}
       should be used to name the maintainers of the package. The file should
       have for each maintainer a line with the following format:
       \begin{verse}
       {\it name} $<${\it email address}$>$\\
       \end{verse}
       For example:
       \begin{verse}
       {\it Susan Hert} $<$hert@mpi-sb.mpg.de$>$\\
       {\it Sylvain Pion} $<$Sylvain.Pion@sophia.inria.fr$>$\\
       \end{verse}
\end{description}


A package has a name, which identifies it.  This name should obey the same
rules as for C identifiers: it consists of letters, digits and underscores and
it does not start with a digit.  Choose a name that is descriptive, yet not
too long (under 25 characters).  If a package deals with objects of a
particular dimension, then use the suffixes \_2, \_3, and \_d, especially if
there exists (or may exist in the future) a package with similar
functionality in different dimensions.  Examples of good package names are
\texttt{Triangulation\_2} for a package dealing with triangulations of points
in the plane and \texttt{Min\_ellipse\_2}, which contains an algorithm that
finds the minimal enclosing ellipse of a set of points in the plane. The
package names \texttt{pm} and \texttt{arr} are a bit too terse.
\texttt{Planar\_map} and \texttt{Arrangement} (or
\texttt{Arrangement\_2}) are better.

\section{{\tt test} subdirectory}
\label{sec:test_subdirectory}
\index{test directory@{\tt test} directory|(}
\ccIndexMainItemBegin{test suite}

This directory contains the test suite for the package. Here we just
briefly list the files contained in such a directory. For more
detailed information about testsuites for \cgal\ packages refer to
Chapter~\ref{chap:testing}. 

\begin{verbatim}
      test/<testdir>
               +--- data/
               |
               +--- include/
               |
               |- CMakeLists.txt
               |
               |- cgal_test
               |
               |- *.cpp
               |
               |- *.cin
\end{verbatim}
where the directory \verb|<testdir>| has a name that corresponds to the package
name.

\begin{description}
   \item[{\tt data/}] is a subdirectory that contains local data files for the
        test suite\index{data directory@{\tt data} directory}.
   \item[{\tt include/}] is a subdirectory that contains local include files for
        the test suite.
   \item[{\tt cgal\_test}]\index{cgal_test script@{\tt cgal\_test}
        script|(} is the script that will be called when the entire
        test suite is run. As this file is created automatically
        during the release process, submitting it is error-prone and
        thus {\bf strongly discouraged}.
        
        For testing purposes, such a script can be created using the
        {\tt create\_cgal\_test}%
        \index{create_cgal_test script@{\tt create\_cgal\_test} script} 
        script (Section~\ref{sec:create_cgal_test}).  
        \index{cgal_test script@{\tt cgal\_test} script|)}

   \item[{\tt CMakeLists.txt}]\ccIndexSubitem{\tt CMakeLists.txt}{test suite} 
        is the CMake configuration file for the test programs. It is created
        automatically, just like {\tt cgal\_test}. Submitting it is 
        {\bf strongly discouraged}, and the only reason for submitting one is
        when the automatic generation script cannot produce a working CMake
        configuration file.
        
        Such a {\tt CMakeLists.txt} can be created using the script
        {\tt cgal\_create\_cmake\_script}%
        \index{cgal_create_cmake_script script@{\tt cgal\_create\_cmake\_script} script} 
        with the argument {\tt -t} 
        (Section~\ref{sec:cgal_create_cmake_script}).
   \item[{\tt *.cpp}] source code for the test programs.
        \ccIndexSubitem{source files}{test suite}

        When a test program runs correctly, it should return
        \ccIndexSubsubitem{test suite}{program}{return value} the
        value zero, or, more precisely, the value \verb|EXIT_SUCCESS|
        defined in \verb|<cstdlib>|.
        Test programs may not be graphical and they may not require any user 
        interaction.\ccIndexSubitem{test suite}{program}   
   \item[{\tt *.cin}] files containing command-line input for 
        \index{test\ suite!input!from {\tt cin}}
        test programs.  These files are necessary for only those programs 
        that require command-line input (which can usually be avoided).  
        If a file \texttt{program.cin} is 
        present in the test directory, then, when the test suite is run,
        \texttt{program} will be executed using the command
        \begin{verbatim}
        ./program < program.cin
        \end{verbatim}
\end{description} 

\section{{\tt doc\_tex} subdirectory}
\label{sec:doc_tex_subdirectory}
\index{doc_tex directory@{\tt doc\_tex} directory|(}
\ccIndexSubitemBegin{manuals}{source files} 
\ccIndexSubitemBegin{source files}{documentation}

As described in Chapter~\ref{chap:specification}, the \cgal\ documentation is
organized in subdirectories for each package and the different manuals
are assembled from these packages. Contained in these
subdirectories are the files required for producing a package's contributions
to the different reference and users' manuals. The users' manual input
files are located in the package's directory; the reference manual files are
be located in a directory named $<Package>${\tt \_ref}
\index{ref directory@{\tt \_ref} directory}.  
For both the users' manual and reference manual parts, the input can be
split into more than one file (In fact, this is necessary for the reference
manual in order to support conversion to HTML; 
see Section~\ref{sec:ref_manual}.), but there must be a file called 
{\tt main.tex} in both the user and reference manual directories that inputs 
all the other files for that manual part.
({\bf Note}: You should use the \verb|\input| command and NOT the 
\verb|\include| command to input other source files in this file, and
they have to include their files using relative paths starting in the
\texttt{doc\_tex} directory.)  

For example, the optimisation package of 
the basic library can have the following documentation. 
\begin{verbatim}
      doc_tex/Optimisation
                 |--- main.tex
                 |
                 |--- *.tex
                 |
                 +--- *.((pdf)|(gif)|(jpg)|(png))

      doc_tex/Optimisation_ref/
                 |--- main.tex
                 |
                 |--- intro.tex
                 |
                 |--- *.tex
                 |
                 +--- *.((pdf)|(gif)|(jpg)|(png))

\end{verbatim}

\begin{description}
 \item[{\tt main.tex}]%
      \ccIndexMainItem{\tt main.tex}\ccIndexSubitem{users' manual}{\tt
      main.tex} must contain one chapter. It must NOT 
      contain a preamble (so no {\tt documentclass}, {\tt usepackage}, 
      \verb|\begin{document}| or \verb|\end{document}| commands). 
      If you want more than one chapter in the documentation of this
      package you have to put each chapter in its own \LaTeX\ file,
      and include those files in \texttt{main.tex} using the \verb|\input|
      macro.
 \item[{\tt intro.tex}]%
      \ccIndexMainItem{\tt intro.tex}%
      \ccIndexSubitem{reference manual}{\tt intro.tex}
      is not mandatory but common for reference manual chapter. It
      contains a brief introduction to the package (one paragraph) and
      lists the different concepts, classes, functions, etc. that are
      contained in this package in a systematic way.
 \item[{\tt *.tex}] -- the source files for the Users' and Reference
      Manual that are input by {\tt main.tex} 
  \item[{\tt *.pdf}] -- the PDF pictures included in
        the PDF documentation.
 \item[{\tt *.((gif)|(jpg)|(png))}] -- the raster images included in
        the HTML documentation.
\end{description}
\ccIndexSubitemEnd{source files}{documentation}
\ccIndexSubitemEnd{manuals}{source files} 
\index{doc_tex directory@{\tt doc\_tex} directory|)}


\section{{\tt examples} subdirectory}
\label{sec:examples_subdirectory}
\index{examples directory@{\tt examples} directory|(}
\ccIndexSubitemBegin{example programs}{submitting}

Example programs (Chapter~\ref{chap:examples_and_demos}) for a package should 
be placed in a subdirectory of the directory {\tt examples}. 
The subdirectory name, \verb|<exampledir>|, will usually correspond to the 
package name, but this is not a requirement.
To make sure that the examples will be tested%
\ccIndexSubitem{test suite}{examples in}, 
a directory with examples 
should be submitted in exactly the same way as a test directory 
(Section~\ref{sec:test_subdirectory}). 

The structure of an example directory should be as follows: 
\begin{verbatim}
      examples/<exampledir>
                   +--- data/
                   |
                   +--- include/
                   |
                   |- README
                   |
                   |- cgal_test
                   |
                   |- CMakeLists.txt
                   |
                   |- *.cpp
\end{verbatim}

\ccIndexSubitem{source files}{examples}
The file {\tt README} should contain information about what the programs do
and how to compile them. 
See the rules for a test directory for an explanation of the other files 
and subdirectories. 
\ccIndexSubitemEnd{example programs}{submitting}
\index{examples directory@{\tt examples} directory|)}


\section{{\tt demo} subdirectory}
\label{sec:demo_subdirectory}
\index{demo directory@{\tt demo} directory|(}
\ccIndexMainItem{demo programs}
\ccIndexSubitemBegin{demo programs}{submitting}

The {\tt demo} directory (Chapter~\ref{chap:examples_and_demos}) contains 
programs with graphical interfaces or programs requiring user input. These 
programs will be compiled but not run by the test suite.
\ccIndexSubitem{test suite}{demos in}
The structure of this directory should be as follows: 
\begin{verbatim}
      demo/<demodir>
            +--- data/
            |
            +--- include/
            |
            |- README
            |
            |- CMakeLists.txt
            |
            |- *.cpp
\end{verbatim}
where \verb|<demodir>| is a name that corresponds (at least in part) to
the package for which it is a demo.
\ccIndexSubitem{source files}{demos}

The file {\tt README} should contain information about what the program does, 
and how to compile it ({\it i.e.}, what graphical libraries are needed, 
{\it etc.}). Note that, in contrast to example and test programs,
demo programs more often need to submit a {\tt CMakeLists.txt}
\ccIndexSubitem{\tt CMakeLists.txt}{demo programs} since
different demos will require different libraries and thus the {\tt CMakeLists.txt}
for these programs will be somewhat dissimilar.
\ccIndexMainItem{demo programs}
\ccIndexSubitemEnd{demo programs}{submitting}
\index{demo directory@{\tt demo} directory|)}


\section{{\tt benchmark} subdirectory}
\label{sec:benchmark_subdirectory}
\index{benchmark directory@{\tt benchmark} directory|(}
\ccIndexSubitemBegin{benchmark programs}{submitting}

Benchmark programs for a package should be placed in a subdirectory of the directory {\tt benchmark}. 
The subdirectory name, \verb|<benchmarkdir>|, will usually correspond to the 
package name, but this is not a requirement.

Benchmark programs are currently not subject to any automatic treatment in the
test-suite, although they could evolve into an automatic benchmark-suite at
some point.  We suggest at directory organization similar to the one of
\verb|<exampledir>|.

Some data sets can be placed under the {\tt data} subdirectory of \verb|<benchmarkdir>|,
but we recommend that only a small number of small files go there.  Extensive
benchmarks data sets should probably be gathered elsewhere, so as not to bloat
the SVN server.

\index{benchmark directory@{\tt benchmark} directory|)}


\ccIndexSubitemEnd{submitting}{directory structure for}
\ccIndexMainItemEnd{directory structure}

\InternalOnly{

\section{Requirements and recommendations\label{sec:directories_req_and_rec}}

\noindent
Requirements:
\begin{itemize}
   \item The directory structure outlined here must be followed exactly.
\end{itemize}

\noindent
Recommendations:
\begin{itemize}
   \item Do not submit {\tt CMakeLists.txt}s for example programs and test suite
         programs.
   \item Do not submit the script {\tt cgal\_test} used to compile and test
         your test suite programs.
\end{itemize}

}
